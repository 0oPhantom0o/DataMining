# DataMining
پیش‌بینی و تحلیل مرگ ‌و ‌میر بیماران با نارسایی قلبی با استفاده از تکنیک‌های داده‌کاوی و یادگیری ماشین
 
نارسایی قلبی یکی از مهم‌ترین علل مرگ ‌و ‌میر در سراسر جهان است و تأثیرات جدی بر کیفیت زندگی بیماران دارد. این بیماری معمولاً به دلیل مشکلات مزمن قلبی عروقی ایجاد می‌شود و مدیریت و درمان آن نیازمند تشخیص زودهنگام و دقیق است. با توجه به اینکه بیماری‌های قلبی عروقی مسئول بیش از 17.9 میلیون مرگ در سال هستند و 31% از کل مرگ‌ها را به خود اختصاص می‌دهند، اهمیت استفاده از روش‌های نوین و کارآمد در تشخیص و پیش‌بینی این بیماری بیش از پیش روشن می‌شود.
در این راستا، تکنیک‌های داده‌کاوی و یادگیری ماشین می‌توانند به عنوان ابزارهای قدرتمندی در تحلیل و پیش‌بینی نارسایی قلبی مورد استفاده قرار گیرند. این تکنیک‌ها با تجزیه و تحلیل داده‌های بالینی بیماران، الگوهای پنهان و روابط پیچیده میان ویژگی‌های مختلف را کشف کرده و با دقت بالایی احتمال وقوع نارسایی قلبی و مرگ ‌و ‌میر ناشی از آن را پیش‌بینی می‌کنند.
هدف این پژوهش، استفاده از مجموعه‌ای از مدل‌های یادگیری ماشین شامل Decision Tree ، Naive Bayes ، Rule Induction  و Logistic Regression برای پیش‌بینی نارسایی قلبی است. با تحلیل داده‌های بالینی 11 ویژگی مختلف، سعی می‌کنیم تا مدلی کارآمد و دقیق برای پیش‌بینی وضعیت بیماران ارائه دهیم. نتایج این پژوهش می‌تواند به بهبود فرآیندهای تشخیصی و درمانی در حوزه پزشکی کمک کرده و در نهایت، منجر به کاهش مرگ ‌و ‌میر ناشی از نارسایی قلبی شود.
### دیتاست
دیتاست مورد استفاده در این پروژه از Kaggle دانلود شده و شامل سوابق بالینی بیماران مبتلا به نارسایی قلبی است. این دیتاست شامل 11 ویژگی و 918 نمونه است که ویژگی‌های مختلفی را در بر می‌گیرد. ویژگی‌های موجود در این دیتاست عبارتند از:
 
- **Age**: سن بیمار به سال
- **Sex**: جنسیت بیمار (M: مرد، F: زن)
- **ChestPainType**: نوع درد قفسه سینه (TA: آنژین تیپیکال، ATA: آنژین آتیپیکال، NAP: درد غیرآنژینال، ASY: بدون علائم)
- **RestingBP**: فشار خون در حال استراحت (mm Hg)
- **Cholesterol**: کلسترول سرم (mg/dl)
- **FastingBS**: قند خون ناشتا (1: اگر قند خون ناشتا > 120 mg/dl، 0: در غیر این صورت)
- **RestingECG**: نتایج الکتروکاردیوگرام در حالت استراحت (Normal: نرمال، ST: ناهنجاری موج ST-T، LVH: هیپرتروفی بطن چپ)
- **MaxHR**: حداکثر ضربان قلب به دست آمده (عدد بین 60 تا 202)
- **ExerciseAngina**: آنژین ناشی از ورزش (Y: بله، N: نه)
- **Oldpeak**: مقدار ST اندازه‌گیری شده در افسردگی (عدد)
- **ST_Slope**: شیب قطعه ST در اوج ورزش (Up: شیب صعودی، Flat: مسطح، Down: شیب نزولی)
- **HeartDisease**: برچسب هدف (1: بیماری قلبی، 0: نرمال)
این دیتاست شامل ترکیبی از داده‌های کمی و کیفی است که امکان تحلیل‌های عمیق‌تر را فراهم می‌کند. بررسی دقیق این ویژگی‌ها و تأثیر آن‌ها بر نارسایی قلبی می‌تواند به شناسایی عوامل مهم و تأثیرگذار کمک کند. به عنوان مثال، سن و حداکثر ضربان قلب به دست آمده (MaxHR) به عنوان دو ویژگی کلیدی در تشخیص و پیش‌بینی نارسایی قلبی شناخته شده‌اند. همچنین، ویژگی‌های مربوط به وضعیت سلامتی عمومی بیمار مانند قند خون ناشتا و آنژین ناشی از ورزش نیز می‌توانند تأثیرات قابل توجهی بر عملکرد قلب داشته باشند.
 
برای آماده‌سازی این دیتاست برای مدل‌سازی، ابتدا داده‌ها به دقت بررسی و پاکسازی شدند. داده‌های ناقص یا نادرست حذف یا تصحیح شدند و برخی از ویژگی‌ها نیز نرمال‌سازی شدند تا اثرات مقیاس‌دهی بر عملکرد مدل‌ها کاهش یابد. این پیش‌پردازش‌ها به بهبود کیفیت داده‌ها و افزایش دقت مدل‌های یادگیری ماشین کمک می‌کنند. به عنوان مثال، نرمال‌سازی ویژگی‌هایی مانند کلسترول و فشار خون در حال استراحت که دارای واحدهای اندازه‌گیری متفاوتی هستند، به مدل‌ها کمک می‌کند تا بهتر الگوهای موجود در داده‌ها را شناسایی کنند.
 
استفاده از این دیتاست به دلیل تنوع ویژگی‌ها و کیفیت بالای داده‌ها، امکان تحلیل جامع و دقیق نارسایی قلبی را فراهم می‌کند. این داده‌ها می‌توانند به پزشکان و محققان در فهم بهتر عوامل مؤثر بر نارسایی قلبی و توسعه مدل‌های پیش‌بینی مؤثرتر کمک کنند. به عنوان مثال، تحلیل داده‌ها نشان می‌دهد که بیماران با سطوح بالاتر قند خون ناشتا و حداکثر ضربان قلب پایین‌تر، احتمال بیشتری برای تجربه نارسایی قلبی دارند. این یافته‌ها می‌توانند به توسعه پروتکل‌های درمانی بهتر و استراتژی‌های پیشگیری مؤثرتر منجر شوند.
### مدل‌ها
 
در این پروژه، چهار مدل مختلف برای تحلیل و پیش‌بینی داده‌ها مورد استفاده قرار گرفته‌اند. این مدل‌ها عبارتند از Decision Tree، Naive Bayes، Rule Induction و Logistic Regression. هر یک از این مدل‌ها ویژگی‌ها و مزایای خاص خود را دارند که در ادامه به تفصیل به آن‌ها پرداخته می‌شود:
 
#### Decision Tree
یک مدل درخت تصمیم است که به صورت بازگشتی شاخه‌بندی می‌کند تا داده‌ها را به دسته‌های مختلف تقسیم کند. این مدل با استفاده از الگوریتم‌های مختلفی مانند ID3، C4.5 و CART ساخته می‌شود.
 
- **مزایا**:
  - قابلیت تفسیر بالا: به راحتی می‌توان ساختار درخت و قوانین تصمیم‌گیری را فهمید.
  - شناسایی ویژگی‌های مهم و الگوهای داده‌ها.
  - توانایی مدل‌سازی تعاملات پیچیده بین ویژگی‌ها.
- **معایب**:
  - حساسیت به داده‌های نویزی و احتمال ایجاد درخت‌های بیش‌برازش (Overfitting) که نیاز به تنظیم پارامترهایی مانند عمق درخت دارند.
- **کاربرد**:
  - Decision Tree در کاربردهای مختلف از جمله تشخیص بیماری‌ها، بازاریابی و مدیریت ریسک مورد استفاده قرار می‌گیرد.
 
#### Naive Bayes
یک مدل مبتنی بر احتمالات بیز ساده است که فرض می‌کند ویژگی‌ها به صورت مستقل از یکدیگر هستند. این مدل معمولاً برای طبقه‌بندی متون و داده‌های دسته‌بندی شده استفاده می‌شود.
 
- **مزایا**:
  - سادگی و سرعت بالا در اجرا و آموزش.
  - کارایی خوب با داده‌های بزرگ و دسته‌بندی‌های متعدد.
- **معایب**:
  - فرض استقلال ویژگی‌ها که در برخی موارد ممکن است نادرست باشد.
  - حساسیت به ویژگی‌های مرتبط که ممکن است دقت مدل را کاهش دهد.
- **کاربرد**:
  - Naive Bayes در تشخیص اسپم، تحلیل احساسات، و دسته‌بندی متون مورد استفاده قرار می‌گیرد.
 
#### Rule Induction
یک مدل مبتنی بر استخراج قوانین است که سعی می‌کند قوانین ساده‌ای برای توضیح و پیش‌بینی داده‌ها ایجاد کند. این مدل با استفاده از الگوریتم‌های مختلفی مانند RIPPER و CN2 ساخته می‌شود.
 
- **مزایا**:
  - قوانین تفسیرپذیر و ساده.
  - مناسب برای داده‌های دسته‌بندی شده.
- **معایب**:
  - ممکن است در مقایسه با مدل‌های پیچیده‌تر دقت کمتری داشته باشد.
  - نیاز به تنظیم پارامترهایی مانند حداقل تعداد موارد در هر قانون.
- **کاربرد**:
  - Rule Induction در کاربردهایی مانند کشف دانش، استخراج قوانین تجاری و تحلیل داده‌های پزشکی استفاده می‌شود.
 
#### Logistic Regression
یک مدل آماری برای تحلیل و پیش‌بینی متغیرهای دودویی است. این مدل با استفاده از تابع لجستیک، احتمال رخداد یک رویداد را بر اساس ویژگی‌های ورودی پیش‌بینی می‌کند.
 
- **مزایا**:
  - قابلیت تفسیر ساده و شفافیت در مدل‌سازی.
  - مناسب برای داده‌های دسته‌بندی شده و پیوسته.
- **معایب**:
  - محدودیت در مدل‌سازی روابط غیرخطی بین ویژگی‌ها.
  - حساسیت به داده‌های نویزی و هم‌خطی ویژگی‌ها.
- **کاربرد**:
  - Logistic Regression در پیش‌بینی ریسک بیماری‌ها، تحلیل رفتار مصرف‌کننده و تحلیل‌های آماری مختلف استفاده می‌شود.
 
### جمع‌بندی
 
استفاده از این مدل‌ها با توجه به ویژگی‌ها و مزایای هر یک، امکان تحلیل جامع و دقیق نارسایی قلبی را فراهم می‌کند. این مدل‌ها می‌توانند به پزشکان و محققان در فهم بهتر عوامل مؤثر بر نارسایی قلبی و توسعه مدل‌های پیش‌بینی مؤثرتر کمک کنند. به عنوان مثال، مدل Decision Tree با قابلیت تفسیر بالا می‌تواند قوانین تصمیم‌گیری ساده‌ای برای تشخیص نارسایی قلبی ارائه دهد، در حالی که مدل Naive Bayes با سرعت بالا و کارایی مناسب برای داده‌های بزرگ، می‌تواند به دسته‌بندی دقیق بیماران کمک کند. مدل Logistic Regression نیز با ارائه یک چارچوب آماری ساده و قابل فهم، می‌تواند در تحلیل ریسک بیماری‌ها و پیش‌بینی نتایج پزشکی موثر باشد.

### پیاده‌سازی مدل‌ها
 
برای پیاده‌سازی و ارزیابی مدل‌ها، از ترکیبی از RapidMiner و اسکریپت‌های پایتون استفاده شده است. فایل project.rmp حاوی فرآیندهای RapidMiner است که مراحل پیش‌پردازش داده‌ها، ساخت و ارزیابی مدل‌ها را انجام می‌دهد. این فرآیندها شامل پاکسازی داده‌ها، تبدیل ویژگی‌ها و نرمال‌سازی است که به بهبود کیفیت داده‌ها کمک می‌کند. علاوه بر این، اسکریپت‌های پایتون شامل DecisionTree.py, NaiveBayes.py, RuleInduction.py, و LogisticRegression.py نیز برای پیاده‌سازی و ارزیابی هر یک از مدل‌ها به کار رفته‌اند.
 
### مراحل انجام شده در RapidMiner شامل:
 
#### پیش‌پردازش داده‌ها:
این مرحله شامل پاکسازی داده‌ها، حذف داده‌های ناقص و نرمال‌سازی ویژگی‌ها است. پیش‌پردازش داده‌ها به منظور بهبود کیفیت داده‌ها و افزایش دقت مدل‌ها انجام می‌شود. 
 
- **پاکسازی داده‌ها**: حذف مقادیر گم‌شده و نادرست.
- **تبدیل ویژگی‌ها**: کدگذاری ویژگی‌های دسته‌بندی شده و نرمال‌سازی ویژگی‌های عددی.
- **نرمال‌سازی**: مقیاس‌دهی داده‌ها به منظور کاهش تأثیرات مقیاس‌های مختلف ویژگی‌ها.
 
#### ساخت مدل‌ها:
ایجاد مدل‌های مختلف بر اساس الگوریتم‌های ذکر شده و تنظیم هایپرپارامترهای مربوط به هر مدل. این مرحله شامل انتخاب ویژگی‌های مناسب، تنظیم پارامترهای مدل‌ها و آموزش مدل‌ها با استفاده از داده‌های موجود است.
 
- **Decision Tree**: ساخت درخت تصمیم‌گیری با تنظیم عمق درخت و معیار تقسیم‌بندی.
- **Naive Bayes**: پیاده‌سازی مدل نایو بیز با فرض استقلال ویژگی‌ها.
- **Rule Induction**: استخراج قوانین ساده با تنظیم پارامترهای مورد نیاز.
- **Logistic Regression**: تنظیم پارامترهای مدل رگرسیون لجستیک و آموزش آن.
 
#### ارزیابی مدل‌ها:
ارزیابی عملکرد هر مدل با استفاده از معیارهایی مانند دقت، دقت مثبت، دقت منفی، نرخ یادآوری و غیره. این مرحله شامل بررسی عملکرد مدل‌ها بر روی داده‌های تست و مقایسه نتایج به دست آمده از هر مدل است.
 
- **دقت**: میزان درستی پیش‌بینی‌ها.
- **دقت مثبت**: صحت پیش‌بینی‌های مثبت.
- **دقت منفی**: صحت پیش‌بینی‌های منفی.
- **نرخ یادآوری**: توانایی مدل در شناسایی موارد مثبت.
 
 
 
این ترکیب از ابزارها و روش‌ها، امکان پیاده‌سازی و ارزیابی دقیق و جامع مدل‌های مختلف را فراهم می‌کند و نتایج حاصل می‌توانند به بهبود فرآیندهای تشخیصی و درمانی در حوزه پزشکی کمک کنند.




### نحوه عملکرد فایل پایتون
 
در این پروژه، یک اسکریپت پایتون با نام HeartFailurePrediction.py برای پیاده‌سازی و ارزیابی مدل‌های مختلف یادگیری ماشین به کار گرفته شده است. این اسکریپت از کتابخانه‌های معروف و قدرتمندی مانند pandas برای بارگذاری و پیش‌پردازش داده‌ها، scikit-learn برای آموزش و ارزیابی مدل‌ها، numpy برای انجام عملیات عددی و imodels برای مدل‌های استخراج قوانین بهره می‌برد. هر چهار مدل یادگیری ماشین شامل Decision Tree، Naive Bayes، Rule Induction و Logistic Regression در این اسکریپت پیاده‌سازی شده‌اند و مراحل مشخصی را طی می‌کنند.
 
### مراحل پیاده‌سازی و ارزیابی
1. **بارگذاری داده‌ها**:
   ابتدا داده‌ها با استفاده از pandas از فایل CSV بارگذاری می‌شوند. این داده‌ها شامل سوابق بالینی بیماران مبتلا به نارسایی قلبی هستند. 
2. **پیش‌پردازش داده‌ها**:
   - **پاکسازی داده‌ها**: حذف داده‌های ناقص و نادرست.
   - **نرمال‌سازی داده‌ها**: با کمک StandardScaler از کتابخانه scikit-learn، داده‌ها نرمال‌سازی می‌شوند.
  
3. **آموزش و ارزیابی مدل‌ها**:
    - **Naive Bayes**:
          - **Decision Tree** 
    - **SVM و Logistic Regression**:
    - **Rule Induction**:
      4. **ذخیره نتایج**:
ذخیره نتایج: نتایج ارزیابی‌های هر مدل در فایل‌های جداگانه ذخیره می‌شوند و برای تجزیه و تحلیل بیشتر نمایش داده می‌شوند. 
### اجرای اسکریپت
 این اسکریپت به طور کلی از رویکردهای استاندارد و تکنیک‌های پیشرفته یادگیری ماشین استفاده می‌کند تا بهترین نتایج ممکن را در پیش‌بینی نارسایی قلبی ارائه دهد.
نتایج مدل‌ها
نتایج به دست آمده از هر مدل نشان‌دهنده عملکرد و دقت پیش‌بینی آن‌ها بر روی دیتاست مورد استفاده است. به طور کلی، مدل Naive Bayes به دلیل فرض استقلال ویژگی‌ها و سرعت بالای اجرا، معمولاً دقت مناسبی ارائه می‌دهد. مدل Decision Tree به دلیل قابلیت تفسیر بالا و شاخه‌بندی داده‌ها، نتایج خوبی دارد. مدل‌های Logistic Regression و Rule Induction نیز عملکرد قابل قبولی دارند، هرچند که هر کدام ویژگی‌ها و محدودیت‌های خاص خود را دارند.
نتایج به دست آمده به شرح زیر است:
1.	Naive Bayes:
•	دقت: حدود 79.75%
•	توضیحات: این مدل با فرض استقلال ویژگی‌ها، دقت مناسبی را ارائه داده و به دلیل سرعت بالا در آموزش و پیش‌بینی، به عنوان یکی از مدل‌های کارآمد شناخته می‌شود.
2.	Decision Tree:
•	دقت: حدود 76.01%
•	توضیحات: این مدل با استفاده از شاخه‌بندی داده‌ها و تعیین قوانین تصمیم‌گیری، دقت خوبی را نشان داده و قابلیت تفسیر بالایی دارد. تنظیمات پارامترها مانند عمق درخت و تعداد نمونه‌ها در هر شاخه به بهبود دقت کمک کرده‌اند.
3.	Logistic Regression:
•	دقت: حدود 74.77%
•	توضیحات: این مدل با استفاده از رگرسیون لجستیک و فرض خطی بودن روابط بین ویژگی‌ها، دقت مناسبی دارد. هرچند که محدودیت‌هایی در مدل‌سازی روابط غیرخطی دارد، اما سادگی و قابلیت تفسیر آن مزایای قابل توجهی است.
4.	Rule Induction:
•	دقت: حدود 72.59%
•	توضیحات: این مدل با استخراج قوانین ساده و قابل تفسیر، دقت قابل قبولی ارائه داده است. با این حال، به دلیل سادگی بیش از حد و عدم مدل‌سازی تعاملات پیچیده بین ویژگی‌ها، دقت کمتری نسبت به مدل‌های پیچیده‌تر دارد.
خلاصه نتایج

 
نتیجه‌گیری
مدل Naive Bayes با دقت بالاتر (79.75%) نسبت به سایر مدل‌ها، بهترین عملکرد را در این پروژه داشته است. مدل Decision Tree نیز با دقت 76.01%، به دلیل قابلیت تفسیر بالا و شاخه‌بندی داده‌ها، نتایج خوبی ارائه داده است. مدل‌های Logistic Regression و Rule Induction نیز هر کدام با دقت‌های مناسب، می‌توانند در شرایط مختلف مفید باشند. این نتایج نشان می‌دهند که استفاده از مدل‌های مختلف یادگیری ماشین می‌تواند به بهبود پیش‌بینی و تحلیل نارسایی قلبی کمک کند
